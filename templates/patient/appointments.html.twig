{% extends 'base.html.twig' %}

{% block navbarDesktop %}
  <nav class="w-full font-poppins">
    <ul class="flex gap-10 justify-end">
      <li>
        <a href="{{ path('app_home') }}" class="text-off-gray hover:text-off-blue font-bold text-[16px]">Accueil</a>
      </li>
      <li>
        <a href="/#contact" class="text-off-gray hover:text-off-blue font-bold text-[16px]">Contact</a>
      </li>
      <li>
        <a href="{{ path('app_patient_profile') }}" class="text-off-gray font-bold text-[16px]">Mon Compte</a>
      </li>
      <li>
        <a href="{{ path('app_patient_appointments') }}" class="text-off-blue hover:text-off-blue font-bold text-[16px]">Mes Rendez-vous</a>
      </li>
      <li class="flex justify-end">
        <div>
          <a href="{{ path('app_logout') }}" class="bg-dark-blue text-white py-2 px-4 rounded hover:bg-off-blue text-[16px]">Déconnexion</a>
        </div>
      </li>
    </ul>
  </nav>
{% endblock %}

{% block navbarMobile %}
  <ul class="flex flex-col items-center justify-center h-full">
    <li class="mb-6">
      <a href="{{ path('app_home') }}" class="text-off-gray hover:text-off-blue text-2xl">Accueil</a>
    </li>
    <li class="mb-6">
      <a href="/#contact" class="text-off-gray hover:text-off-blue text-2xl">Contact</a>
    </li>
    {% if app.user and ('ROLE_USER' in app.user.roles or 'ROLE_PATIENT' in app.user.roles) and not ('ROLE_ADMIN' in app.user.roles or 'ROLE_DOCTOR' in app.user.roles) %}
      <li class="mb-6">
        <a href="{{ path('app_patient_profile') }}" class="text-off-gray text-2xl">Mon Compte</a>
      </li>
      <li class="mb-6">
        <a href="{{ path('app_patient_appointments') }}" class="text-off-blue hover:text-off-blue text-2xl">Mes Rendez-vous</a>
      </li>
    {% endif %}
      <li class="mb-6">
        <a href="{{ path('app_logout') }}" class="bg-dark-blue text-white py-2 px-4 rounded hover:bg-off-blue text-2xl">Déconnexion</a>
      </li>
  </ul>
{% endblock %}

{% block main %}
<section class="mt-[90px] w-full font-poppins bg-off-test py-8">
  <div class="container mx-auto px-4 py-8">
    <h1 class="text-2xl font-bold text-dark-gray mb-6">Mes Rendez-vous Disponibles</h1>

    <div class="flex flex-col items-center gap-6">
      {% for appointment in appointments %}
        <div class="bg-white shadow-lg rounded-lg w-1/2 p-6 border-2 border-dotted border-dark-blue">
          <div class="flex items-center gap-4 mb-4">
            <img 
              src="{{ appointment.doctor.profileImage ? asset('uploads/profiles/' ~ appointment.doctor.profileImage) : asset('img/default2.png') }}" 
              alt="Doctor Profile Image" 
              class="w-16 h-16 rounded-full object-cover"
            />
            <div>
              <h2 class="text-lg font-bold text-dark-gray">{{ appointment.doctor.firstName }} {{ appointment.doctor.lastName }}</h2>
              <p class="text-sm text-off-gray">{{ appointment.doctor.specialty ? appointment.doctor.specialty.name : 'Spécialité non spécifiée' }}</p>
            </div>
          </div>
          <p class="text-sm text-dark-gray mb-2"><strong>Adresse:</strong> {{ appointment.doctor.address }}</p>
          <p class="text-sm text-dark-gray mb-4"><strong>Date et Heure:</strong> {{ appointment.date|date('d/m/Y H:i') }}</p>
          
          <div class="flex justify-end">
            <a  href="{{ path('app_patient_book_appointment', { id: appointment.id }) }}" class="block text-center bg-dark-blue text-white py-2 px-4 rounded hover:bg-off-blue">
              Prendre Rendez-vous
            </a>
          </div>  
        </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endblock %}